<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Digital Footprint Quest ‚Äî Game interaktif</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --brand: #6d28d9;
            --brand-2: #22d3ee;
            --accent: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --ink: #0f172a;
        }

        html,
        body {
            height: 100%;
        }

        body {
            font-family: 'Plus Jakarta Sans', system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
        }

        /* Soft animated gradient background */
        .bg-animated {
            background: radial-gradient(1200px 600px at 10% 10%, rgba(34, 211, 238, .20), transparent 50%),
                radial-gradient(900px 600px at 90% 20%, rgba(109, 40, 217, .20), transparent 50%),
                radial-gradient(1000px 800px at 50% 100%, rgba(245, 158, 11, .15), transparent 50%),
                linear-gradient(120deg, #0b1020 0%, #0a0f1a 50%, #0b1328 100%);
            animation: float-bg 18s ease-in-out infinite alternate;
        }

        @keyframes float-bg {
            0% {
                background-position: 0px 0px, 0px 0px, 0px 0px, 0 0;
            }

            100% {
                background-position: 30px -20px, -40px 30px, 20px -30px, 0 0;
            }
        }

        /* Nice glass card */
        .glass {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
        }

        .glass-strong {
            backdrop-filter: blur(16px);
            background: rgba(255, 255, 255, 0.12);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }

        .btn {
            transition: transform .08s ease, box-shadow .2s ease, background .2s ease;
            box-shadow: 0 8px 18px rgba(109, 40, 217, .25);
        }

        .btn:hover {
            transform: translateY(-1px);
        }

        .btn:active {
            transform: translateY(0);
        }

        .choice {
            transition: transform .12s ease, background .2s ease, border-color .2s ease, box-shadow .2s ease;
        }

        .choice:hover {
            transform: translateY(-2px);
        }

        .pulse {
            animation: pulse 1.2s ease-in-out infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.04);
                opacity: .9;
            }
        }

        .footprint path {
            transition: fill .3s ease, opacity .3s ease, transform .3s ease;
        }

        .footprint.filled path {
            fill: #22d3ee;
            opacity: 1;
            transform: translateY(-2px);
        }

        .footprint.empty path {
            fill: #334155;
            opacity: .55;
        }

        .ribbon {
            position: absolute;
            inset: -1px;
            background: conic-gradient(from 180deg at 50% 50%, rgba(34, 211, 238, .25), rgba(109, 40, 217, .25), rgba(245, 158, 11, .2), rgba(34, 211, 238, .25));
            filter: blur(28px);
            opacity: .5;
            z-index: 0;
            border-radius: 20px;
        }

        .draggable {
            cursor: grab;
        }

        .draggable:active {
            cursor: grabbing;
        }

        .dropzone {
            transition: border-color .2s ease, background .2s ease, transform .12s ease;
        }

        .dropzone.drag-over {
            border-color: var(--brand-2);
            background: rgba(34, 211, 238, .08);
            transform: translateY(-2px);
            box-shadow: inset 0 0 0 1px rgba(34, 211, 238, .2), 0 8px 18px rgba(34, 211, 238, .15);
        }

        /* Confetti emojis */
        .confetti {
            position: fixed;
            top: -20px;
            font-size: 22px;
            z-index: 50;
            animation: fall 1.6s ease-in forwards;
            will-change: transform, opacity;
        }

        @keyframes fall {
            0% {
                transform: translateY(-20px) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(110vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Accessibility focus */
        .focus-ring:focus-visible {
            outline: 3px solid #22d3ee;
            outline-offset: 2px;
            border-radius: .5rem;
        }
    </style>
</head>

<body class="bg-animated text-slate-100 min-h-full">
    <div class="relative min-h-full">
        <!-- Decorative floating orbs -->
        <div class="pointer-events-none absolute -top-16 -left-16 w-64 h-64 rounded-full opacity-30"
            style="background: radial-gradient(circle, rgba(34,211,238,.25), transparent 60%); filter: blur(18px);">
        </div>
        <div class="pointer-events-none absolute -bottom-24 -right-12 w-72 h-72 rounded-full opacity-20"
            style="background: radial-gradient(circle, rgba(109,40,217,.25), transparent 60%); filter: blur(22px);">
        </div>

        <header class="max-w-6xl mx-auto px-6 pt-10">
            <div class="flex flex-col md:flex-row items-start md:items-center gap-6">
                <div class="relative glass-strong rounded-2xl p-6 md:p-7 w-full">
                    <div class="ribbon"></div>
                    <div class="relative z-10 flex items-start md:items-center gap-4">
                        <div
                            class="flex items-center justify-center w-14 h-14 rounded-xl bg-cyan-400/20 ring-2 ring-cyan-300/30">
                            <span class="text-3xl" aria-hidden="true">ü¶∂</span>
                        </div>
                        <div class="flex-1">
                            <h1 class="text-2xl md:text-3xl font-extrabold tracking-tight">
                                Digital Footprint Quest
                            </h1>
                            <p class="text-slate-300 mt-1 md:mt-2">
                                Buat pilihan cerdas di dunia online, kumpulkan poin, dan jaga jejak digitalmu tetap
                                bersih.
                            </p>
                        </div>
                        <button id="restartTop"
                            class="btn focus-ring px-4 py-2 rounded-xl bg-violet-600 hover:bg-violet-500 active:bg-violet-700">
                            Restart
                        </button>
                    </div>
                </div>
            </div>
        </header>

        <main class="max-w-6xl mx-auto px-6 py-6 md:py-8">
            <!-- Stats Row -->
            <section class="grid md:grid-cols-3 gap-4 md:gap-6">
                <!-- Progress -->
                <div class="glass rounded-2xl p-5">
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm uppercase tracking-wider text-slate-300">Progress</span>
                        <span id="progressText" class="text-sm font-semibold">1 / 6</span>
                    </div>
                    <div class="w-full h-3 bg-slate-800/70 rounded-full overflow-hidden">
                        <div id="progressBar" class="h-full bg-gradient-to-r from-cyan-400 to-violet-500 rounded-full"
                            style="width: 0%;"></div>
                    </div>
                </div>
                <!-- Score -->
                <div class="glass rounded-2xl p-5">
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm uppercase tracking-wider text-slate-300">Score</span>
                        <span id="scoreText" class="text-xl font-extrabold">0</span>
                    </div>
                    <div class="flex items-center gap-2 text-slate-300 text-sm">
                        <span class="text-emerald-300">+10</span> untuk pilihan bijak,
                        <span class="text-rose-300">-5</span> untuk pilihan berisiko.
                    </div>
                </div>
                <!-- Footprint Meter -->
                <div class="glass rounded-2xl p-5">
                    <div class="flex items-center justify-between mb-3">
                        <span class="text-sm uppercase tracking-wider text-slate-300">Footprint Meter</span>
                        <span id="meterLabel" class="text-sm font-semibold">Clean</span>
                    </div>
                    <div id="footprintWrap" class="flex items-center gap-3">
                        <!-- 5 footprints -->
                        <svg class="footprint empty w-8 h-8" viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M7.5 2.5c1-.8 2.5-.7 3.3.3.9 1 .7 2.6-.3 3.4-.9.7-2.2.6-3-.1-.9-.9-.9-2.6 0-3.6zM12.7 4.5c.9-.5 2-.2 2.6.6.6.9.4 2.1-.5 2.7-.8.6-1.9.4-2.5-.3-.7-.8-.5-2 .4-3zM16.8 7.5c.8-.4 1.7-.1 2.2.6.5.8.3 1.8-.4 2.3-.7.5-1.7.3-2.1-.4-.5-.7-.3-1.7.3-2.5zM5 7.5c-1.7 1.5-2.5 3.6-2.2 5.7.4 2.6 2.7 4.6 5.4 4.8 1.9.2 3.9-.5 5.1-2 1.2-1.5 1.3-3.6.4-5.2-1-1.8-3.2-2.7-5.5-2.6-1 .1-2 .3-3.2.9z" />
                        </svg>
                        <svg class="footprint empty w-8 h-8" viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M7.5 2.5c1-.8 2.5-.7 3.3.3.9 1 .7 2.6-.3 3.4-.9.7-2.2.6-3-.1-.9-.9-.9-2.6 0-3.6zM12.7 4.5c.9-.5 2-.2 2.6.6.6.9.4 2.1-.5 2.7-.8.6-1.9.4-2.5-.3-.7-.8-.5-2 .4-3zM16.8 7.5c.8-.4 1.7-.1 2.2.6.5.8.3 1.8-.4 2.3-.7.5-1.7.3-2.1-.4-.5-.7-.3-1.7.3-2.5zM5 7.5c-1.7 1.5-2.5 3.6-2.2 5.7.4 2.6 2.7 4.6 5.4 4.8 1.9.2 3.9-.5 5.1-2 1.2-1.5 1.3-3.6.4-5.2-1-1.8-3.2-2.7-5.5-2.6-1 .1-2 .3-3.2.9z" />
                        </svg>
                        <svg class="footprint empty w-8 h-8" viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M7.5 2.5c1-.8 2.5-.7 3.3.3.9 1 .7 2.6-.3 3.4-.9.7-2.2.6-3-.1-.9-.9-.9-2.6 0-3.6zM12.7 4.5c.9-.5 2-.2 2.6.6.6.9.4 2.1-.5 2.7-.8.6-1.9.4-2.5-.3-.7-.8-.5-2 .4-3zM16.8 7.5c.8-.4 1.7-.1 2.2.6.5.8.3 1.8-.4 2.3-.7.5-1.7.3-2.1-.4-.5-.7-.3-1.7.3-2.5zM5 7.5c-1.7 1.5-2.5 3.6-2.2 5.7.4 2.6 2.7 4.6 5.4 4.8 1.9.2 3.9-.5 5.1-2 1.2-1.5 1.3-3.6.4-5.2-1-1.8-3.2-2.7-5.5-2.6-1 .1-2 .3-3.2.9z" />
                        </svg>
                        <svg class="footprint empty w-8 h-8" viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M7.5 2.5c1-.8 2.5-.7 3.3.3.9 1 .7 2.6-.3 3.4-.9.7-2.2.6-3-.1-.9-.9-.9-2.6 0-3.6zM12.7 4.5c.9-.5 2-.2 2.6.6.6.9.4 2.1-.5 2.7-.8.6-1.9.4-2.5-.3-.7-.8-.5-2 .4-3zM16.8 7.5c.8-.4 1.7-.1 2.2.6.5.8.3 1.8-.4 2.3-.7.5-1.7.3-2.1-.4-.5-.7-.3-1.7.3-2.5zM5 7.5c-1.7 1.5-2.5 3.6-2.2 5.7.4 2.6 2.7 4.6 5.4 4.8 1.9.2 3.9-.5 5.1-2 1.2-1.5 1.3-3.6.4-5.2-1-1.8-3.2-2.7-5.5-2.6-1 .1-2 .3-3.2.9z" />
                        </svg>
                        <svg class="footprint empty w-8 h-8" viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M7.5 2.5c1-.8 2.5-.7 3.3.3.9 1 .7 2.6-.3 3.4-.9.7-2.2.6-3-.1-.9-.9-.9-2.6 0-3.6zM12.7 4.5c.9-.5 2-.2 2.6.6.6.9.4 2.1-.5 2.7-.8.6-1.9.4-2.5-.3-.7-.8-.5-2 .4-3zM16.8 7.5c.8-.4 1.7-.1 2.2.6.5.8.3 1.8-.4 2.3-.7.5-1.7.3-2.1-.4-.5-.7-.3-1.7.3-2.5zM5 7.5c-1.7 1.5-2.5 3.6-2.2 5.7.4 2.6 2.7 4.6 5.4 4.8 1.9.2 3.9-.5 5.1-2 1.2-1.5 1.3-3.6.4-5.2-1-1.8-3.2-2.7-5.5-2.6-1 .1-2 .3-3.2.9z" />
                        </svg>
                    </div>
                </div>
            </section>

            <!-- Game Card -->
            <section class="relative mt-6 md:mt-8 glass-strong rounded-2xl p-5 md:p-7">
                <div class="ribbon"></div>
                <div class="relative z-10">
                    <div class="flex items-start gap-3 mb-4">
                        <div
                            class="w-10 h-10 rounded-lg bg-violet-500/20 flex items-center justify-center ring-2 ring-violet-400/30">
                            <span class="text-xl">üß†</span>
                        </div>
                        <div class="flex-1">
                            <h2 id="roundTitle" class="text-xl md:text-2xl font-bold">Round 1</h2>
                            <p id="roundSubtitle" class="text-slate-300 mt-1">Think it through and pick the best choice.
                            </p>
                        </div>
                    </div>

                    <div id="contentArea" class="mt-2">
                        <!-- Dynamic content will render here -->
                    </div>

                    <div class="mt-6 flex flex-col md:flex-row gap-3 md:items-center md:justify-between">
                        <div id="feedback" class="hidden rounded-xl p-4 text-sm"></div>
                        <div class="flex gap-3">
                            <button id="checkBtn"
                                class="btn focus-ring px-5 py-3 rounded-xl bg-emerald-600 hover:bg-emerald-500 active:bg-emerald-700 hidden">
                                Check
                            </button>
                            <button id="nextBtn"
                                class="btn focus-ring px-5 py-3 rounded-xl bg-cyan-600 hover:bg-cyan-500 active:bg-cyan-700 disabled:opacity-40 disabled:cursor-not-allowed">
                                Selanjutnya
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Tips -->
            <section class="mt-6 grid md:grid-cols-3 gap-4">
                <div class="glass rounded-2xl p-5">
                    <div class="flex items-center gap-3">
                        <div
                            class="w-10 h-10 rounded-lg bg-cyan-500/20 ring-2 ring-cyan-400/30 flex items-center justify-center">
                            üîí</div>
                        <div>
                            <p class="font-semibold">Pikir dulu sebelum berbagi</p>
                            <p class="text-slate-300 text-sm mt-1">Jika itu mengungkap siapa dirimu atau di mana kamu
                                berada, simpanlah tetap pribadi.</p>
                        </div>
                    </div>
                </div>
                <div class="glass rounded-2xl p-5">
                    <div class="flex items-center gap-3">
                        <div
                            class="w-10 h-10 rounded-lg bg-amber-500/20 ring-2 ring-amber-400/30 flex items-center justify-center">
                            üí¨</div>
                        <div>
                            <p class="font-semibold">Jadilah baik dan bijak</p>
                            <p class="text-slate-300 text-sm mt-1">Komentar bisa bertahan lama dan mudah dibagikan.</p>
                        </div>
                    </div>
                </div>
                <div class="glass rounded-2xl p-5">
                    <div class="flex items-center gap-3">
                        <div
                            class="w-10 h-10 rounded-lg bg-emerald-500/20 ring-2 ring-emerald-400/30 flex items-center justify-center">
                            üåê</div>
                        <div>
                            <p class="font-semibold">Periksa pengaturan privasi</p>
                            <p class="text-slate-300 text-sm mt-1">Gunakan opsi hanya-teman dan batasi siapa saja yang
                                bisa menghubungimu.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- End Screen (hidden initially) -->
            <section id="endScreen" class="hidden mt-8">
                <div class="glass-strong rounded-2xl p-6">
                    <div class="flex items-start gap-4">
                        <div
                            class="w-12 h-12 rounded-xl bg-emerald-500/20 ring-2 ring-emerald-400/30 flex items-center justify-center">
                            <span class="text-2xl">üèÜ</span>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-2xl font-extrabold">Kerja bagus!</h3>
                            <p id="endSummary" class="text-slate-300 mt-1">Kamu sudah membuat pilihan dengan bijak dan
                                menjaga jejak digitalmu tetap bersih.</p>
                        </div>
                    </div>

                    <div id="badges" class="mt-5 grid sm:grid-cols-3 gap-4"></div>

                    <div class="mt-6 flex flex-wrap gap-3">
                        <button id="restartBtn"
                            class="btn focus-ring px-5 py-3 rounded-xl bg-violet-600 hover:bg-violet-500 active:bg-violet-700">
                            Main Lagi
                        </button>
                        <button id="downloadBtn"
                            class="btn focus-ring px-5 py-3 rounded-xl bg-amber-600 hover:bg-amber-500 active:bg-amber-700">
                            Download Ringkasan
                        </button>
                    </div>
                </div>
            </section>

            <footer class="py-10"></footer>
        </main>
    </div>

    <script>
        // Game data
        const rounds = [
            {
                id: 'scenario_post',
                type: 'choice',
                title: 'Kamu memotret foto di depan rumahmu.',
                subtitle: 'Bolehkah kamu mempostingnya jika nama jalan rumahmu terlihat di latar belakang?',
                options: [
                    {
                        id: 'a', label: 'Ya, tidak apa-apa. Fotonya keren!', correct: false, impact: -5,
                        explain: 'Nama jalan bisa memberi petunjuk tentang lokasi rumahmu. Potong atau buramkan detailnya sebelum memposting.'
                    },
                    {
                        id: 'b', label: 'Tetap posting, tetapi sembunyikan atau buramkan alamat atau nama jalan.', correct: true, impact: +10,
                        explain: 'Betul! Menghapus petunjuk lokasi membantu menjaga keamananmu.'
                    },
                    {
                        id: 'c', label: 'Jangan pernah posting apa pun.', correct: false, impact: -5,
                        explain: 'Memposting foto kadang-kadang tidak apa-apa. Pikirkan dengan cermat dan kurangi detail pribadi.'
                    },
                ],
                emoji: 'üì∏'
            },
            {
                id: 'friend_request',
                type: 'choice',
                title: 'Permintaan pertemanan baru!',
                subtitle: 'Namanya mirip dengan nama teman sekolahmu, tapi profilnya kosong.',
                options: [
                    {
                        id: 'a',
                        label: 'Langsung terima supaya tidak dianggap kasar.',
                        correct: false,
                        impact: -5,
                        explain: 'Akun yang tidak dikenal bisa saja palsu. Jangan terima sebelum memastikan siapa dia.'
                    },
                    {
                        id: 'b',
                        label: 'Tanyakan dulu ke teman asli atau orangnya langsung di kehidupan nyata.',
                        correct: true,
                        impact: +10,
                        explain: 'Pintar! Verifikasi dulu, baru putuskan. Informasimu jadi lebih aman.'
                    },
                    {
                        id: 'c',
                        label: 'Bagikan nomor teleponmu untuk memastikan kalau itu benar dia.',
                        correct: false,
                        impact: -5,
                        explain: 'Memberikan nomor telepon berarti membocorkan informasi pribadi‚Äîhindari hal itu.'
                    },
                ],

                emoji: 'üßë‚Äçü§ù‚Äçüßë'
            },
            {
                id: 'privacy_settings',
                type: 'choice',
                title: 'Saatnya mengatur privasi.',
                subtitle: 'Pengaturan mana yang paling membatasi siapa yang bisa melihat postinganmu?',
                options: [
                    {
                        id: 'a',
                        label: 'Publik: semua orang bisa melihat dan membagikan.',
                        correct: false,
                        impact: -5,
                        explain: 'Mode publik berarti semua orang bisa melihat‚Äîbahkan orang yang tidak kamu kenal.'
                    },
                    {
                        id: 'b',
                        label: 'Hanya teman atau daftar khusus.',
                        correct: true,
                        impact: +10,
                        explain: 'Bagus! Membatasi siapa yang bisa melihat postingan membuat jejak digitalmu lebih kecil.'
                    },
                    {
                        id: 'c',
                        label: 'Temannya teman.',
                        correct: false,
                        impact: -5,
                        explain: 'Itu jauh lebih banyak orang daripada yang kamu kira.'
                    },
                ],
                emoji: 'üîí'
            },
            {
                id: 'drag_classify',
                type: 'dragdrop',
                title: 'Ayo sortir informasi!',
                subtitle: 'Seret setiap kartu ke ‚ÄúBagikan ke Publik‚Äù atau ‚ÄúSimpan Pribadi‚Äù.',
                items: [
                    { id: 'home_address', text: 'Alamat rumah', correctZone: 'private' },
                    { id: 'fav_sport', text: 'Olahraga favorit', correctZone: 'public' },
                    { id: 'school_name', text: 'Nama sekolah', correctZone: 'private' },
                    { id: 'pet_video', text: 'Video hewan peliharaan lucu', correctZone: 'public' },
                    { id: 'report_card', text: 'Rapor sekolah', correctZone: 'private' },
                    { id: 'birthday', text: 'Tanggal lahir (bulan/hari)', correctZone: 'private' },
                ],

                scoring: { perCorrect: 8, perWrong: -3, bonusAllCorrect: 2, minShow: 0, maxShow: 6 },
                emoji: 'üóÇÔ∏è'
            },
            {
                id: 'kind_comment',
                type: 'choice',
                title: 'Kamu melihat komentar jahat di postingan temanmu.',
                subtitle: 'Apa respon terbaik?',
                options: [
                    {
                        id: 'a',
                        label: 'Tambahkan lelucon supaya dapat banyak like.',
                        correct: false,
                        impact: -5,
                        explain: 'Komentar yang tidak baik akan tetap ada di internet dan bisa merusak reputasimu.'
                    },
                    {
                        id: 'b',
                        label: 'Dukung temanmu dan laporkan komentar jahat itu.',
                        correct: true,
                        impact: +10,
                        explain: 'Kebaikan itu penting. Melaporkan membantu menjaga ruang online tetap aman.'
                    },
                    {
                        id: 'c',
                        label: 'Bagikan ke lebih banyak orang untuk menunjukkan betapa jahatnya komentar itu.',
                        correct: false,
                        impact: -5,
                        explain: 'Membagikan justru menyebarkan dampak buruk dan hal negatif.'
                    },
                ],
                emoji: 'üí¨'
            },
            {
                id: 'password_share',
                type: 'choice',
                title: 'Seorang teman meminta password-mu untuk ‚Äúmemperbaiki‚Äù akunmu.',
                subtitle: 'Apa yang seharusnya kamu lakukan?',
                options: [
                    {
                        id: 'a',
                        label: 'Berikan saja karena dia temanmu.',
                        correct: false,
                        impact: -5,
                        explain: 'Jangan pernah membagikan password. Mintalah bantuan orang dewasa terpercaya atau bantuan resmi.'
                    },
                    {
                        id: 'b',
                        label: 'Tolak, dan aktifkan perlindungan tambahan seperti verifikasi 2 langkah.',
                        correct: true,
                        impact: +10,
                        explain: 'Bagus sekali. Jaga akunmu tetap pribadi dan aman.'
                    },
                    {
                        id: 'c',
                        label: 'Kirimkan petunjuk lewat chat yang sebenarnya hampir sama dengan password-mu.',
                        correct: false,
                        impact: -5,
                        explain: 'Petunjuk bisa membocorkan password juga. Simpanlah tetap rahasia.'
                    },
                ],
                emoji: 'üõ°Ô∏è'
            },
        ];

        // State
        let state = {
            index: 0,
            score: 0,
            answers: [], // {id, choiceId/dragMap, correct, delta, note}
        };

        // Elements
        const contentArea = document.getElementById('contentArea');
        const nextBtn = document.getElementById('nextBtn');
        const checkBtn = document.getElementById('checkBtn');
        const feedback = document.getElementById('feedback');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const scoreText = document.getElementById('scoreText');
        const roundTitle = document.getElementById('roundTitle');
        const roundSubtitle = document.getElementById('roundSubtitle');
        const meterLabel = document.getElementById('meterLabel');
        const footprintWrap = document.getElementById('footprintWrap');

        const endScreen = document.getElementById('endScreen');
        const endSummary = document.getElementById('endSummary');
        const badges = document.getElementById('badges');
        const restartBtn = document.getElementById('restartBtn');
        const restartTop = document.getElementById('restartTop');
        const downloadBtn = document.getElementById('downloadBtn');

        // Utility
        function updateHeader() {
            const total = rounds.length;
            progressText.textContent = `${Math.min(state.index + 1, total)} / ${total}`;
            const percent = (state.index / total) * 100;
            progressBar.style.width = `${Math.min(percent, 100)}%`;
            scoreText.textContent = state.score;

            // Update footprints based on score bands
            const filled = Math.max(0, Math.min(5, Math.floor((state.score + 5) / 12))); // rough scaling
            [...footprintWrap.children].forEach((fp, i) => {
                fp.classList.remove('filled', 'empty');
                fp.classList.add(i < filled ? 'filled' : 'empty');
            });

            meterLabel.textContent =
                state.score >= 45 ? 'Keren banget' :
                    state.score >= 30 ? 'Bagus' :
                        state.score >= 15 ? 'Lumayan' :
                            state.score >= 0 ? 'Perlu diperbaiki' : 'Bahaya';
        }

        function setFeedback(kind, message) {
            feedback.classList.remove('hidden');
            feedback.className = 'rounded-xl p-4 text-sm';
            if (kind === 'good') {
                feedback.classList.add('bg-emerald-500/15', 'ring-1', 'ring-emerald-400/30', 'text-emerald-200');
            } else if (kind === 'bad') {
                feedback.classList.add('bg-rose-500/15', 'ring-1', 'ring-rose-400/30', 'text-rose-200');
            } else {
                feedback.classList.add('bg-slate-500/15', 'ring-1', 'ring-slate-400/30', 'text-slate-200');
            }
            feedback.textContent = message;
        }

        function confettiBurst() {
            const emojis = ['üéâ', '‚ú®', 'üåü', 'üéà', 'üéä', 'üí´'];
            for (let i = 0; i < 14; i++) {
                const span = document.createElement('span');
                span.className = 'confetti';
                span.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                span.style.left = Math.random() * 100 + 'vw';
                span.style.animationDelay = (Math.random() * 0.4) + 's';
                span.style.filter = `hue-rotate(${Math.floor(Math.random() * 360)}deg)`;
                // PENTING: jangan biarkan confetti menangkap klik
                span.style.pointerEvents = 'none';
                // taruh sedikit di bawah z-index kontrol UI supaya tidak menutup tombol
                span.style.zIndex = '20';
                document.body.appendChild(span);
                setTimeout(() => span.remove(), 2000);
            }
        }

        function render() {
            feedback.classList.add('hidden');
            checkBtn.classList.add('hidden');
            nextBtn.disabled = true;

            const round = rounds[state.index];
            if (!round) return;

            roundTitle.textContent = `Pertanyaan ${state.index + 1} ${round.emoji ? '‚Ä¢ ' + round.emoji : ''}`;
            roundSubtitle.textContent = round.subtitle;

            if (round.type === 'choice') {
                renderChoice(round);
            } else if (round.type === 'dragdrop') {
                renderDragDrop(round);
            }

            updateHeader();
        }

        function renderChoice(round) {
            const optionHTML = round.options.map(opt => `
        <button data-id="${opt.id}" class="choice focus-ring w-full text-left p-4 rounded-xl bg-slate-900/50 ring-1 ring-white/10 hover:bg-slate-800/60">
          <div class="flex items-start gap-3">
            <div class="w-9 h-9 rounded-lg bg-gradient-to-br from-violet-500/30 to-cyan-500/30 flex items-center justify-center ring-1 ring-white/10">
              <span class="text-base">üåê</span>
            </div>
            <div class="flex-1">
              <p class="font-semibold">${opt.label}</p>
            </div>
          </div>
        </button>
      `).join('');

            contentArea.innerHTML = `
        <div class="rounded-2xl p-5 bg-slate-900/40 ring-1 ring-white/10">
          <h3 class="text-lg font-bold mb-2">${round.title}</h3>
          <div class="grid gap-3 mt-3">${optionHTML}</div>
        </div>
      `;

            contentArea.querySelectorAll('.choice').forEach(btn => {
                btn.addEventListener('click', () => {
                    // disable all
                    contentArea.querySelectorAll('.choice').forEach(b => b.disabled = true);
                    const pickedId = btn.getAttribute('data-id');
                    const picked = round.options.find(o => o.id === pickedId);
                    const correct = !!picked.correct;
                    const delta = picked.impact;

                    // style
                    btn.classList.remove('ring-white/10');
                    btn.classList.add(
                        correct ? 'ring-emerald-400/40' : 'ring-rose-400/40',
                        correct ? 'bg-emerald-500/10' : 'bg-rose-500/10'
                    );

                    // reveal correct option if wrong
                    if (!correct) {
                        const right = round.options.find(o => o.correct);
                        const rightBtn = contentArea.querySelector(`[data-id="${right.id}"]`);
                        if (rightBtn) {
                            rightBtn.classList.add('ring-emerald-400/40', 'bg-emerald-500/10');
                        }
                    }

                    // update score
                    state.score += delta;
                    state.answers.push({ id: round.id, choiceId: pickedId, correct, delta, note: picked.explain });

                    setFeedback(correct ? 'good' : 'bad', picked.explain);
                    if (correct) confettiBurst();

                    updateHeader();
                    nextBtn.disabled = false;
                }, { once: true });
            });
        }

        // Drag & Drop (perbaikan)
        function renderDragDrop(round) {
            checkBtn.classList.remove('hidden');

            const itemsHTML = round.items.map(item => `
    <div class="draggable choice focus-ring p-3 rounded-xl bg-slate-900/50 ring-1 ring-white/10 hover:bg-slate-800/60" draggable="true" data-id="${item.id}" role="button" aria-grabbed="false" tabindex="0">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-amber-500/30 to-rose-500/30 flex items-center justify-center ring-1 ring-white/10">
          <span>üîé</span>
        </div>
        <p class="font-semibold">${item.text}</p>
      </div>
    </div>
  `).join('');

            contentArea.innerHTML = `
    <div class="rounded-2xl p-5 bg-slate-900/40 ring-1 ring-white/10">
      <h3 class="text-lg font-bold mb-2">${round.title}</h3>
      <p class="text-slate-300">${round.subtitle}</p>

      <div class="mt-4 grid md:grid-cols-3 gap-4">
        <div class="md:col-span-1">
          <div class="rounded-xl bg-slate-800/50 ring-1 ring-white/10 p-3 min-h-[220px]" id="pool" aria-label="Items to sort">
            <div class="grid gap-3" id="poolItems">
              ${itemsHTML}
            </div>
          </div>
        </div>

        <div class="md:col-span-2 grid sm:grid-cols-2 gap-4">
          <div class="dropzone rounded-xl bg-slate-800/40 ring-2 ring-white/10 p-4 min-h-[180px]" data-zone="public" aria-label="Share Publicly">
            <div class="flex items-center gap-2 mb-2">
              <span>üì¢</span>
              <p class="font-semibold">Bagikan ke Publik</p>
            </div>
            <div class="grid gap-3 min-h-[120px]" id="publicZone"></div>
          </div>
          <div class="dropzone rounded-xl bg-slate-800/40 ring-2 ring-white/10 p-4 min-h-[180px]" data-zone="private" aria-label="Keep Private">
            <div class="flex items-center gap-2 mb-2">
              <span>üîê</span>
              <p class="font-semibold">Simpan Pribadi</p>
            </div>
            <div class="grid gap-3 min-h-[120px]" id="privateZone"></div>
          </div>
        </div>
      </div>
    </div>
  `;

            setupDnD(round);
        }

        function setupDnD(round) {
            const draggables = contentArea.querySelectorAll('.draggable');
            const zones = contentArea.querySelectorAll('.dropzone');
            let currentDragId = null;

            // make draggables interactive
            draggables.forEach(el => {
                el.addEventListener('dragstart', (e) => {
                    currentDragId = el.getAttribute('data-id');
                    el.classList.add('ring-cyan-400/50');
                    el.setAttribute('aria-grabbed', 'true');
                    try {
                        e.dataTransfer.setData('text/plain', currentDragId);
                        e.dataTransfer.effectAllowed = 'move';
                    } catch (err) {
                        // some browsers in certain contexts may throw ‚Äî ignore safely
                    }
                });

                el.addEventListener('dragend', () => {
                    currentDragId = null;
                    el.classList.remove('ring-cyan-400/50');
                    el.setAttribute('aria-grabbed', 'false');
                });

                // keyboard support: cycle through poolItems -> publicZone -> privateZone
                el.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        const parentContainer = el.closest('#poolItems, #publicZone, #privateZone');
                        const zonesArr = ['poolItems', 'publicZone', 'privateZone'];
                        const parentId = parentContainer ? parentContainer.id : 'poolItems';
                        const nextId = zonesArr[(zonesArr.indexOf(parentId) + 1) % zonesArr.length];
                        const nextEl = document.getElementById(nextId);
                        if (nextEl) nextEl.appendChild(el);
                    }
                });
            });

            // drop behavior for public/private zones
            zones.forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.classList.add('drag-over');
                });

                zone.addEventListener('dragleave', () => zone.classList.remove('drag-over'));

                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('drag-over');

                    // prefer dataTransfer id, fallback to currentDragId
                    const droppedId = (e.dataTransfer && e.dataTransfer.getData && e.dataTransfer.getData('text/plain')) || currentDragId;
                    const draggedEl = droppedId ? contentArea.querySelector(`.draggable[data-id="${droppedId}"]`) : null;

                    // target container inside the zone: e.g. data-zone="public" -> #publicZone
                    const targetContainerId = zone.dataset.zone + 'Zone';
                    const targetContainer = document.getElementById(targetContainerId) || zone.querySelector('.grid') || zone;

                    if (draggedEl && targetContainer) {
                        targetContainer.appendChild(draggedEl);
                    }
                });
            });

            // allow dropping back to pool
            const pool = document.getElementById('pool');
            if (pool) {
                pool.addEventListener('dragover', (e) => e.preventDefault());
                pool.addEventListener('drop', (e) => {
                    e.preventDefault();
                    const droppedId = (e.dataTransfer && e.dataTransfer.getData && e.dataTransfer.getData('text/plain')) || currentDragId;
                    const draggedEl = droppedId ? contentArea.querySelector(`.draggable[data-id="${droppedId}"]`) : null;
                    const poolItems = document.getElementById('poolItems');
                    if (draggedEl && poolItems) poolItems.appendChild(draggedEl);
                });
            }

            // scoring / check button
            checkBtn.onclick = () => {
                const perCorrect = (round.scoring && typeof round.scoring.perCorrect === 'number') ? round.scoring.perCorrect : 10;
                const perWrong = (round.scoring && typeof round.scoring.perWrong === 'number') ? round.scoring.perWrong : -5;
                const bonusAllCorrect = (round.scoring && typeof round.scoring.bonusAllCorrect === 'number') ? round.scoring.bonusAllCorrect : 2;

                const placed = {};
                const publicZone = document.getElementById('publicZone');
                const privateZone = document.getElementById('privateZone');

                publicZone && publicZone.querySelectorAll('.draggable').forEach(el => placed[el.getAttribute('data-id')] = 'public');
                privateZone && privateZone.querySelectorAll('.draggable').forEach(el => placed[el.getAttribute('data-id')] = 'private');

                let correctCount = 0;
                let wrongCount = 0;

                round.items.forEach(it => {
                    const zone = placed[it.id];
                    const isCorrect = zone === it.correctZone;
                    const card = contentArea.querySelector(`.draggable[data-id="${it.id}"]`);
                    if (card) {
                        // reset previous result classes (avoid duplicates)
                        card.classList.remove('ring-white/10', 'ring-emerald-400/40', 'bg-emerald-500/10', 'ring-rose-400/40', 'bg-rose-500/10');
                        if (isCorrect) {
                            card.classList.add('ring-emerald-400/40', 'bg-emerald-500/10');
                            correctCount++;
                        } else {
                            card.classList.add('ring-rose-400/40', 'bg-rose-500/10');
                            wrongCount++;
                        }
                    } else {
                        // if card not found (shouldn't happen normally) still count for scoring
                        if (isCorrect) correctCount++; else wrongCount++;
                    }
                });

                if (wrongCount === 0 && correctCount === round.items.length) {
                    state.score += 2; // bonus for perfect
                }

                const delta = correctCount * perCorrect + wrongCount * perWrong;

                state.score = (typeof state.score === 'number' ? state.score : 0) + delta;
                state.answers = state.answers || [];
                state.answers.push({
                    id: round.id,
                    dragMap: placed,
                    correct: (wrongCount === 0 && correctCount > 0),
                    delta,
                    note: `Kamu menempatkan ${correctCount} benar dan ${wrongCount} yang perlu perbaikan.`
                });

                setFeedback(
                    wrongCount === 0 ? 'good' : (correctCount ? 'neutral' : 'bad'),
                    wrongCount === 0
                        ? 'Kerja bagus! Semua item sudah berada di tempat yang tepat.'
                        : `Kerja bagus! ${correctCount} benar, ${wrongCount} perlu perbaikan. Publik = informasi tidak mengungkap identitas, Privat = informasi pribadi.`
                );

                if (wrongCount === 0 && typeof confettiBurst === 'function') confettiBurst();

                updateHeader && updateHeader();
                nextBtn && (nextBtn.disabled = false);
                checkBtn.classList.add('hidden');
            };
        }


        function next() {
            if (state.index < rounds.length - 1) {
                state.index += 1;
                render();
            } else {
                showEnd();
            }
        }

        function showEnd() {
            document.querySelector('section.relative.mt-6').classList.add('hidden');
            endScreen.classList.remove('hidden');

            // Summary text
            const correctCount = state.answers.filter(a => a.correct).length;
            const total = rounds.length;
            endSummary.textContent = `Score: ${state.score}. You nailed ${correctCount} of ${total} rounds with safe choices!`;

            // Badges
            badges.innerHTML = '';
            const badgeList = [];
            if (state.score >= 50) badgeList.push({ name: 'Footprint Hero', color: 'from-emerald-400 to-cyan-400', emoji: 'üåü' });
            if (state.answers.some(a => a.id === 'drag_classify' && a.correct)) badgeList.push({ name: 'Sorting Pro', color: 'from-amber-400 to-pink-400', emoji: 'üß©' });
            if (state.answers.find(a => a.id === 'kind_comment' && a.correct)) badgeList.push({ name: 'Kindness Ambassador', color: 'from-violet-400 to-fuchsia-400', emoji: 'üíñ' });
            if (state.answers.find(a => a.id === 'privacy_settings' && a.correct)) badgeList.push({ name: 'Privacy Protector', color: 'from-indigo-400 to-blue-400', emoji: 'üõ°Ô∏è' });

            if (badgeList.length === 0) badgeList.push({ name: 'Rising Learner', color: 'from-slate-300 to-slate-100', emoji: 'üéì' });

            badgeList.forEach(b => {
                const el = document.createElement('div');
                el.className = 'rounded-2xl p-4 glass';
                el.innerHTML = `
          <div class="flex items-center gap-3">
            <div class="w-12 h-12 rounded-xl bg-gradient-to-br ${b.color} text-slate-900 font-extrabold flex items-center justify-center">
              <span class="text-xl">${b.emoji}</span>
            </div>
            <div>
              <p class="font-bold">${b.name}</p>
              <p class="text-slate-300 text-sm">Mantap, progresmu keren!</p>
            </div>
          </div>
        `;
                badges.appendChild(el);
            });
        }

        function restart() {
            state = { index: 0, score: 0, answers: [] };
            document.querySelector('section.relative.mt-6').classList.remove('hidden');
            endScreen.classList.add('hidden');
            render();
        }

        function downloadSummary() {
            const lines = [];
            lines.push('Digital Footprint Quest ‚Äî Ringkasan');
            lines.push(`Skor: ${state.score}`);
            lines.push('');
            state.answers.forEach((a, i) => {
                const r = rounds.find(x => x.id === a.id);
                lines.push(`Pertanyaan ${i + 1}: ${r?.title || a.id}`);
                if (a.choiceId) {
                    const opt = r.options.find(o => o.id === a.choiceId);
                    lines.push(`- Pilihanmu: ${opt?.label || a.choiceId}`);
                    lines.push(`- Hasil: ${a.correct ? 'Pintar' : 'Riskan'} (${a.delta >= 0 ? '+' : ''}${a.delta})`);
                    lines.push(`- Catatan: ${a.note}`);
                } else if (a.dragMap) {
                    lines.push(`- Mengelompokkan:`);
                    Object.entries(a.dragMap).forEach(([k, v]) => {
                        const item = r.items.find(it => it.id === k);
                        lines.push(`  ‚Ä¢ ${item?.text || k} ‚Üí ${v}`);
                    });
                    lines.push(`- Hasil: ${a.correct ? 'Sempurna' : 'Campur'} (${a.delta >= 0 ? '+' : ''}${a.delta})`);
                    lines.push(`- Catatan: ${a.note}`);
                }
                lines.push('');
            });
            const blob = new Blob([lines.join('\n')], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'digital-footprint-quest-ringakasan.txt';
            document.body.appendChild(a);
            a.click();
            setTimeout(() => {
                URL.revokeObjectURL(url);
                a.remove();
            }, 0);
        }

        // Events
        nextBtn.addEventListener('click', (e) => {
            e.preventDefault();
            next();
        });
        restartBtn.addEventListener('click', (e) => { e.preventDefault(); restart(); });
        restartTop.addEventListener('click', (e) => { e.preventDefault(); restart(); });
        downloadBtn.addEventListener('click', (e) => { e.preventDefault(); downloadSummary(); });

        // Init
        render();
    </script>
    <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'983703fa827ac4b3',t:'MTc1ODU5ODc3My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

</html>
